"use strict";(self.webpackChunkrslib_website=self.webpackChunkrslib_website||[]).push([["9078"],{9290:function(s,e,n){n.r(e),n.d(e,{default:()=>l});var i=n(813),r=n(7522);function o(s){let e={a:"a",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...(0,r.a)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.h1,{id:"configure-rslib",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-rslib",children:"#"}),"Configure Rslib"]}),"\n",(0,i.jsxs)(e.p,{children:["Rslib's configuration is based on Rsbuild, which means that you can use all of Rsbuild configurations, as well as the ",(0,i.jsx)(e.code,{children:"lib"})," configuration specific to Rslib."]}),"\n",(0,i.jsxs)(e.h2,{id:"configuration-structure",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-structure",children:"#"}),"Configuration structure"]}),"\n",(0,i.jsxs)(e.p,{children:["Rslib provides the ",(0,i.jsx)(e.code,{children:"lib"})," option to configure the library outputs. It is an array, and each object is used to describe a format of the output."]}),"\n",(0,i.jsxs)(e.p,{children:["For example, output ESM and CJS formats, and use ",(0,i.jsx)(e.code,{children:"es2021"})," syntax:"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"rslib.config.mjs",children:(0,i.jsxs)(e.code,{className:"language-js",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  lib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    { format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'esm'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" syntax"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'es2021'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    { format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'cjs'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" syntax"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'es2021'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n",(0,i.jsxs)(e.h3,{id:"common-rsbuild-configurations",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#common-rsbuild-configurations",children:"#"}),"Common Rsbuild configurations"]}),"\n",(0,i.jsxs)(e.p,{children:["You can set common Rsbuild configurations outside the ",(0,i.jsx)(e.code,{children:"lib"})," field, which will be inherited by each configuration object inside the ",(0,i.jsx)(e.code,{children:"lib"})," field."]}),"\n",(0,i.jsxs)(e.p,{children:["For example, set the ",(0,i.jsx)(e.a,{href:"/config/rsbuild/output#outputtarget",children:"output.target"})," of Rsbuild to ",(0,i.jsx)(e.code,{children:"web"}),", which will affect the output of all ",(0,i.jsx)(e.code,{children:"lib"})," configuration objects:"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"rslib.config.mjs",children:(0,i.jsxs)(e.code,{className:"language-js",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  lib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    { format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'esm'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" syntax"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'es2021'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    { format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'cjs'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" syntax"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'es2021'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  output"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    target"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'web'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n",(0,i.jsxs)(e.h3,{id:"separate-rsbuild-configurations",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#separate-rsbuild-configurations",children:"#"}),"Separate Rsbuild configurations"]}),"\n",(0,i.jsxs)(e.p,{children:["In the ",(0,i.jsx)(e.code,{children:"lib"})," field, you can set separate Rsbuild configurations for each output format, which will override the common Rsbuild configurations outside the ",(0,i.jsx)(e.code,{children:"lib"})," field."]}),"\n",(0,i.jsxs)(e.p,{children:["For example, separately set the ",(0,i.jsx)(e.a,{href:"/config/rsbuild/output#outputtarget",children:"output.target"})," of the ESM output to ",(0,i.jsx)(e.code,{children:"web"}),":"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"rslib.config.mjs",children:(0,i.jsxs)(e.code,{className:"language-js",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  lib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"    // The target of the ESM output is `web`"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    {"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'esm'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      output"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"        target"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'web'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"    // The CJS output inherits the common configuration and target is `node`"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    {"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'cjs'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  output"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    target"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'node'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n",(0,i.jsxs)(e.p,{children:["Rslib will generate the ",(0,i.jsx)(e.a,{href:"https://rsbuild.rs/config/environments",rel:"noopener noreferrer",target:"_blank",children:"environments"})," configuration of Rsbuild internally, please refer to ",(0,i.jsx)(e.a,{href:"#configuration-debug",children:"Configuration Debug"})," to view the final generated configuration."]}),"\n",(0,i.jsxs)(e.p,{children:["You can also refer to the ",(0,i.jsx)(e.a,{href:"/config/",children:"Configuration Overview"})," page to view the detailed introduction of all configurations."]}),"\n",(0,i.jsxs)(e.h2,{id:"configuration-file",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-file",children:"#"}),"Configuration file"]}),"\n",(0,i.jsx)(e.p,{children:"When you use the CLI of Rslib, Rslib will automatically read the configuration file in the root directory of the current project and resolve it in the following order:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.mjs"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.ts"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.js"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.cjs"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.mts"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"rslib.config.cts"})}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["We recommend using the ",(0,i.jsx)(e.code,{children:".mjs"})," or ",(0,i.jsx)(e.code,{children:".ts"})," format for the configuration file and importing the ",(0,i.jsx)(e.code,{children:"defineConfig"})," utility function from ",(0,i.jsx)(e.code,{children:"@rslib/core"}),". It provides friendly TypeScript type hints and autocompletion, which can help you avoid errors in the configuration."]}),"\n",(0,i.jsxs)(e.p,{children:["For example, in ",(0,i.jsx)(e.code,{children:"rslib.config.ts"}),", you can define the Rslib ",(0,i.jsx)(e.a,{href:"/config/lib/syntax",children:"syntax"})," configuration and the Rsbuild ",(0,i.jsx)(e.a,{href:"https://rsbuild.rs/config/output/target#outputtarget",rel:"noopener noreferrer",target:"_blank",children:"output.target"})," configuration:"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"rslib.config.ts",children:(0,i.jsxs)(e.code,{className:"language-ts",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" { defineConfig } "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@rslib/core'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(e.span,{className:"line"}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" defineConfig"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  lib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    {"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'esm'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      syntax"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'es2021'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  output"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    target"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'node'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),"\n",(0,i.jsxs)(e.p,{children:["If you are developing a non-TypeScript project, you can use the ",(0,i.jsx)(e.code,{children:".mjs"})," format for the configuration file."]}),"\n",(0,i.jsxs)(e.div,{className:"rspress-directive tip",children:[(0,i.jsx)(e.div,{className:"rspress-directive-title",children:"TIP"}),(0,i.jsx)(e.div,{className:"rspress-directive-content",children:(0,i.jsxs)(e.p,{children:["When you use the ",(0,i.jsx)(e.code,{children:".ts"}),", ",(0,i.jsx)(e.code,{children:".mts"}),", and ",(0,i.jsx)(e.code,{children:".cts"})," extensions, Rslib will use ",(0,i.jsx)(e.a,{href:"https://github.com/unjs/jiti",rel:"noopener noreferrer",target:"_blank",children:"jiti"})," to load configuration files, providing interoperability between ESM and CommonJS. The behavior of module resolution differs slightly from the native behavior of Node.js."]})})]}),"\n",(0,i.jsxs)(e.h2,{id:"specify-config-file",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#specify-config-file",children:"#"}),"Specify config file"]}),"\n",(0,i.jsxs)(e.p,{children:["Rslib CLI uses the ",(0,i.jsx)(e.code,{children:"--config"})," option to specify the config file, which can be set to a relative path or an absolute path."]}),"\n",(0,i.jsxs)(e.p,{children:["For example, if you need to use the ",(0,i.jsx)(e.code,{children:"rslib.prod.config.mjs"})," file when running ",(0,i.jsx)(e.code,{children:"build"}),", you can add the following scripts to ",(0,i.jsx)(e.code,{children:"package.json"}),":"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"package.json",children:(0,i.jsxs)(e.code,{className:"language-json",children:[(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "scripts"'}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:'    "build"'}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "rslib build --config rslib.prod.config.mjs"'})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,i.jsxs)(e.p,{children:["You can also abbreviate the ",(0,i.jsx)(e.code,{children:"--config"})," option to ",(0,i.jsx)(e.code,{children:"-c"}),":"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,i.jsx)(e.code,{className:"language-bash",children:(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"rslib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:" build"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:" -c"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:" rslib.prod.config.mjs"})]})})})}),"\n",(0,i.jsxs)(e.h2,{id:"using-environment-variables",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#using-environment-variables",children:"#"}),"Using environment variables"]}),"\n",(0,i.jsxs)(e.p,{children:["In the configuration file, you can use Node.js environment variables such as ",(0,i.jsx)(e.code,{children:"process.env.NODE_ENV"})," to dynamically set different configurations:"]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"rslib.config.ts",children:(0,i.jsxs)(e.code,{className:"language-ts",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" { defineConfig } "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@rslib/core'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(e.span,{className:"line"}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" default"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" defineConfig"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  lib"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    {"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      format"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'esm'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  source"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    alias"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"      '@request'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"        process"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"env"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"NODE_ENV"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ==="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'development'"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"          ?"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" './src/request.dev.js'"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"          :"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" './src/request.prod.js'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),"\n",(0,i.jsxs)(e.h2,{id:"configure-rsbuild",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-rsbuild",children:"#"}),"Configure Rsbuild"]}),"\n",(0,i.jsxs)(e.p,{children:["Rslib allows you to use most of the Rsbuild configurations. Currently, the ",(0,i.jsx)(e.code,{children:"environments"})," config is not supported because it is generated internally by Rslib."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Refer to ",(0,i.jsx)(e.a,{href:"/config/rsbuild/",children:"Rsbuild Configuration"})," for common Rsbuild configurations."]}),"\n",(0,i.jsxs)(e.li,{children:["Refer to ",(0,i.jsx)(e.a,{href:"https://rsbuild.rs/config/index#config-overview",rel:"noopener noreferrer",target:"_blank",children:"Rsbuild Documentation"})," for all Rsbuild configurations."]}),"\n"]}),"\n",(0,i.jsxs)(e.h2,{id:"configure-rspack",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-rspack",children:"#"}),"Configure Rspack"]}),"\n",(0,i.jsxs)(e.p,{children:["Rslib is built on top of Rsbuild and Rsbuild supports directly modifying the Rspack configuration object and also supports modifying the built-in Rspack configuration of Rsbuild through ",(0,i.jsx)(e.code,{children:"rspack-chain"}),". This means you can configure Rspack related configurations in an Rslib project as well."]}),"\n",(0,i.jsxs)(e.p,{children:["For more details, refer to ",(0,i.jsx)(e.a,{href:"https://rsbuild.rs/guide/basic/configure-rspack",rel:"noopener noreferrer",target:"_blank",children:"Configure Rspack"}),"."]}),"\n",(0,i.jsxs)(e.h2,{id:"configuration-debug",children:[(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-debug",children:"#"}),"Configuration debug"]}),"\n",(0,i.jsxs)(e.p,{children:["You can enable Rslib's debug mode by adding the ",(0,i.jsx)(e.code,{children:"DEBUG=rsbuild"})," environment variable when executing a build. It will display the final Rsbuild/Rspack configuration after processing by Rslib."]}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,i.jsx)(e.code,{className:"language-bash",children:(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"DEBUG"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"rsbuild"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" pnpm"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:" build"})]})})})}),"\n",(0,i.jsx)(e.p,{children:"In debug mode, Rslib will write the Rsbuild / Rspack config to the dist directory, which is convenient for developers to view and debug."}),"\n",(0,i.jsx)(e.p,{children:"Here is an example of a library that sets both CJS and ESM formats:"}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,i.jsxs)(e.code,{className:"language-txt",children:[(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{children:"Inspect config succeed, open following files to view the content:"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{children:"  - Rsbuild Config (esm): /project/dist/.rsbuild/rsbuild.config.esm.mjs"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{children:"  - Rsbuild Config (cjs): /project/dist/.rsbuild/rsbuild.config.cjs.mjs"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{children:"  - Rspack Config (esm): /project/dist/.rsbuild/rspack.config.esm.mjs"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{children:"  - Rspack Config (cjs): /project/dist/.rsbuild/rspack.config.cjs.mjs"})})]})})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Open the generated ",(0,i.jsx)(e.code,{children:"/dist/.rsbuild/rsbuild.config.esm.mjs"})," file to see the complete content of the Rsbuild config."]}),"\n",(0,i.jsxs)(e.li,{children:["Open the generated ",(0,i.jsx)(e.code,{children:"/dist/.rsbuild/rspack.config.esm.mjs"})," file to see the complete content of the Rspack config."]}),"\n"]})]})}function l(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}={...(0,r.a)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(o,{...s})}):o(s)}l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["en%2Fguide%2Fbasic%2Fconfigure-rslib.mdx"]={toc:[{id:"configuration-structure",text:"Configuration structure",depth:2},{id:"common-rsbuild-configurations",text:"Common Rsbuild configurations",depth:3},{id:"separate-rsbuild-configurations",text:"Separate Rsbuild configurations",depth:3},{id:"configuration-file",text:"Configuration file",depth:2},{id:"specify-config-file",text:"Specify config file",depth:2},{id:"using-environment-variables",text:"Using environment variables",depth:2},{id:"configure-rsbuild",text:"Configure Rsbuild",depth:2},{id:"configure-rspack",text:"Configure Rspack",depth:2},{id:"configuration-debug",text:"Configuration debug",depth:2}],title:"Configure Rslib",headingTitle:"Configure Rslib",frontmatter:{}}}}]);